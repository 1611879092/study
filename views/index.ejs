<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <% include header.ejs %>
    <link rel="stylesheet" href="stylesheets/swiper.min.css">
    <style>
        .layui-layer {
            background: none !important;
        }

        .aui-list-header {
            border-left: 3px solid #ddd;
            padding-left: 0.8rem;
            background: none !important;
        }
    </style>
</head>
<body>
<div id="app">
    <div class="aui-info aui-padded-l-10 aui-padded-r-10 infos">
        <div class="aui-info-item">
            <img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAHgAAAB4CAMAAAAOusbgAAAAeFBMVEUAwAD///+U5ZTc9twOww7G8MYwzDCH4YcfyR9x23Hw+/DY9dhm2WZG0kbT9NP0/PTL8sux7LFe115T1VM+zz7i+OIXxhes6qxr2mvA8MCe6J6M4oz6/frr+us5zjn2/fa67rqB4IF13XWn6ad83nxa1loqyirn+eccHxx4AAAC/klEQVRo3u2W2ZKiQBBF8wpCNSCyLwri7v//4bRIFVXoTBBB+DAReV5sG6lTXDITiGEYhmEYhmEYhmEYhmEY5v9i5fsZGRx9PyGDne8f6K9cfd+mKXe1yNG/0CcqYE86AkBMBh66f20deBc7wA/1WFiTwvSEpBMA2JJOBsSLxe/4QEEaJRrASP8EVF8Q74GbmevKg0saa0B8QbwBdjRyADYxIhqxAZ++IKYtciPXLQVG+imw+oo4Bu56rjEJ4GYsvPmKOAB+xlz7L5aevqUXuePWVhvWJ4eWiwUQ67mK51qPj4dFDMlRLBZTqF3SDvmr4BwtkECu5gHWPkmDfQh02WLxXuvbvC8ku8F57GsI5e0CmUwLz1kq3kD17R1In5816rGvQ5VMk5FEtIiWislTffuDpl/k/PzscdQsv8r9qWq4LRWX6tQYtTxvI3XyrwdyQxChXioOngH3dLgOFjk0all56XRi/wDFQrGQU3Os5t0wJu1GNtNKHdPqYaGYQuRDfbfDf26AGLYSyGS3ZAK4S8XuoAlxGSdYMKwqZKM9XJMtyqXi7HX/CiAZS6d8bSVUz5J36mEMFDTlAFQzxOT1dzLRljjB6+++ejFqka+mXIe6F59mw22OuOw1F4T6lg/9VjL1rLDoI9Xzl1MSYDNHnPQnt3D1EE7PrXjye/3pVpr1Z45hMUdcACc5NVQI0bOdS1WA0wuz73e7/5TNqBPhQXPEFGJNV2zNqWI7QKBd2Gn6AiBko02zuAOXeWIXjV0jNqdKegaE/kJQ6Bfs4aju04lMLkA2T5wBSYPKDGF3RKhFYEa6A1L1LG2yacmsaZ6YPOSAMKNsO+N5dNTfkc5Aqe26uxHpx7ZirvgCwJpWq/lmX1hA7LyabQ34tt5RiJKXSwQ+0KU0V5xg+hZrd4Bn1n4EID+WkQdgLfRNtvil9SPfwy+WQ7PFBWQz6dGWZBLkeJFXZGCfLUjCgGgqXo5TuSu3cugdcTv/HjqnBTEMwzAMwzAMwzAMwzAMw/zf/AFbXiOA6frlMAAAAABJRU5ErkJggg=="
                 style="width:1.5rem" class="aui-img-round"/><span class="aui-margin-l-5">路人甲</span>
            <ul class="grade aui-margin-l-10">
                <li>0</li>
                <li>5</li>
            </ul>
        </div>
        <div class="aui-info-item"><a href="###">同步</a></div>
    </div>
    <div class="aui-content">
        <section class="aui-grid aui-padded-15">
            <div class="aui-row aui-padded-t-10 aui-padded-b-10 aui-border-b"
                 style="box-shadow: 0 0 0.3rem #bbb;width: 98%;margin: 0 auto;border-radius: 0.3rem">
                <div class="aui-col-xs-4 aui-padded-t-0 aui-padded-b-0">
                    <h2>1
                        <small>&nbsp;道</small>
                    </h2>
                    <div class="aui-grid-label">累计做题</div>
                </div>
                <div class="aui-col-xs-4 aui-border-l aui-padded-t-0 aui-padded-b-0">
                    <h2>0
                        <small>&nbsp;道</small>
                    </h2>
                    <div class="aui-grid-label">今日做题</div>
                </div>
                <div class="aui-col-xs-4 aui-border-l aui-padded-t-0 aui-padded-b-0">
                    <h2>1
                        <small>&nbsp;天</small>
                    </h2>
                    <div class="aui-grid-label">累计学习</div>
                </div>
            </div>
        </section>
        <div class="aui-list aui-media-list aui-border-t aui-margin-t-10 aui-padded-t-5">
            <div class="aui-list-header aui-font-size-16 aui-margin-10">
                图文列表
            </div>
            <div id="top">
                <div class="swiper-container aui-text-center" id="nav" style="height: 1.5rem">
                    <div class="swiper-wrapper">
                        <div class="swiper-slide" @click="getpracticemenu(1)">
                            <span style="color:rgba(66,129,239,1);">SC</span></div>
                        <div class="swiper-slide" @click="getpracticemenu(2)">
                            <span>CR</span></div>
                        <div class="swiper-slide" @click="getpracticemenu(3)">
                            <span>RC</span></div>
                        <div class="swiper-slide" @click="getpracticemenu(4)">
                            <span>PS</span></div>
                        <div class="swiper-slide" @click="getpracticemenu(5)">
                            <span>DS</span></div>
                        <div class="bar">
                            <div class="color"></div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="swiper-container aui-margin-t-10 aui-padded-b-10" id="page">
                <div class="swiper-wrapper">
                    <div class="swiper-slide slidepage">
                        <ul class="aui-list aui-media-list aui-list-noborder">
                            <a :href="'/material?id='+practicemenu.id" class="aui-list-item" v-if="practicemenus1.length !=0" v-for="practicemenu in practicemenus1">
                                <div class="aui-media-list-item-inner">
                                    <div class="aui-list-item-inner">
                                        <div class="aui-list-item-text">
                                            <div class="aui-list-item-title" v-text="practicemenu.name"></div>
                                            <div class="aui-list-item-right aui-font-size-16">
                                                <small>完成度：</small>
                                                0%
                                            </div>
                                        </div>
                                        <div class="aui-list-item-text aui-margin-t-10 aui-margin-b-10">
                                            <div class="aui-progress aui-progress-xs">
                                                <div class="aui-progress-bar" style="width: 60%;"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </a>
                            <p v-else>暂没有分类</p>
                        </ul>
                    </div>
                    <div class="swiper-slide slidepage">
                        <ul class="aui-list aui-media-list aui-list-noborder">
                            <a :href="'/material?id='+practicemenu.id" class="aui-list-item" v-if="practicemenus2.length != 0" v-for="practicemenu in practicemenus2">
                                <div class="aui-media-list-item-inner">
                                    <div class="aui-list-item-inner">
                                        <div class="aui-list-item-text">
                                            <div class="aui-list-item-title" v-text="practicemenu.name"></div>
                                            <div class="aui-list-item-right aui-font-size-16">
                                                <small>完成度：</small>
                                                0%
                                            </div>
                                        </div>
                                        <div class="aui-list-item-text aui-margin-t-10 aui-margin-b-10">
                                            <div class="aui-progress aui-progress-xs">
                                                <div class="aui-progress-bar" style="width: 60%;"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </a>
                            <p v-else>暂没有分类</p>
                        </ul>
                    </div>
                    <div class="swiper-slide slidepage">
                        <ul class="aui-list aui-media-list aui-list-noborder">
                            <a :href="'/material?id='+practicemenu.id" class="aui-list-item" v-if="practicemenus3.length != 0" v-for="practicemenu in practicemenus3">
                                <div class="aui-media-list-item-inner">
                                    <div class="aui-list-item-inner">
                                        <div class="aui-list-item-text">
                                            <div class="aui-list-item-title" v-text="practicemenu.name"></div>
                                            <div class="aui-list-item-right aui-font-size-16">
                                                <small>完成度：</small>
                                                0%
                                            </div>
                                        </div>
                                        <div class="aui-list-item-text aui-margin-t-10 aui-margin-b-10">
                                            <div class="aui-progress aui-progress-xs">
                                                <div class="aui-progress-bar" style="width: 60%;"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </a>
                            <p v-if="practicemenus3.length == 0">暂没有分类</p>
                        </ul>
                    </div>
                    <div class="swiper-slide slidepage">
                        <ul class="aui-list aui-media-list aui-list-noborder">
                            <a :href="'/material?id='+practicemenu.id" class="aui-list-item" v-if="practicemenus4.length != 0" v-for="practicemenu in practicemenus4">
                                <div class="aui-media-list-item-inner">
                                    <div class="aui-list-item-inner">
                                        <div class="aui-list-item-text">
                                            <div class="aui-list-item-title" v-text="practicemenu.name"></div>
                                            <div class="aui-list-item-right aui-font-size-16">
                                                <small>完成度：</small>
                                                0%
                                            </div>
                                        </div>
                                        <div class="aui-list-item-text aui-margin-t-10 aui-margin-b-10">
                                            <div class="aui-progress aui-progress-xs">
                                                <div class="aui-progress-bar" style="width: 60%;"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </a>
                            <p v-if="practicemenus4.length == 0">暂没有分类</p>
                        </ul>
                    </div>
                    <div class="swiper-slide slidepage">
                        <ul class="aui-list aui-media-list aui-list-noborder">
                            <a :href="'/material?id='+practicemenu.id" class="aui-list-item" v-if="practicemenus5.length != 0" v-for="practicemenu in practicemenus5">
                                <div class="aui-media-list-item-inner">
                                    <div class="aui-list-item-inner">
                                        <div class="aui-list-item-text">
                                            <div class="aui-list-item-title" v-text="practicemenu.name"></div>
                                            <div class="aui-list-item-right aui-font-size-16">
                                                <small>完成度：</small>
                                                0%
                                            </div>
                                        </div>
                                        <div class="aui-list-item-text aui-margin-t-10 aui-margin-b-10">
                                            <div class="aui-progress aui-progress-xs">
                                                <div class="aui-progress-bar" style="width: 60%;"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </a>
                            <p v-if="practicemenus5.length == 0">暂没有分类</p>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        <div class="aui-list aui-media-list aui-margin-t-10 aui-padded-t-5 aui-padded-b-10">
            <div class="aui-list-header aui-font-size-16 aui-margin-10">
                难易练习
            </div>
            <section class="aui-grid nylx">
                <div class="aui-row">
                    <div class="aui-col-xs-4">
                        <div class="aui-grid-label">OG-难</div>
                    </div>
                    <div class="aui-col-xs-4">
                        <div class="aui-grid-label">OG-中</div>
                    </div>
                    <div class="aui-col-xs-4">
                        <div class="aui-grid-label">OG-易</div>
                    </div>
                </div>
            </section>
        </div>
        <div class="aui-list aui-media-list aui-margin-t-10 aui-padded-t-5 aui-padded-b-10 bkzn">
            <div class="aui-list-header aui-font-size-16 aui-margin-10">
                备考指南
            </div>
            <li class="aui-list-item">
                <div class="aui-media-list-item-inner">
                    <div class="aui-list-item-media">
                        <img src="../../image/demo1.png">
                    </div>
                    <div class="aui-list-item-inner">
                        <div class="aui-list-item-text">
                            <div class="aui-list-item-title">带有媒体的列表二</div>
                        </div>
                        <div class="aui-list-item-text">
                            在下方我们加入了aui-info信息条
                        </div>
                    </div>
                </div>
            </li>
            <li class="aui-list-item">
                <div class="aui-media-list-item-inner">
                    <div class="aui-list-item-media">
                        <img src="../../image/demo1.png">
                    </div>
                    <div class="aui-list-item-inner">
                        <div class="aui-list-item-text">
                            <div class="aui-list-item-title">带有媒体的列表二</div>
                        </div>
                        <div class="aui-list-item-text">
                            在下方我们加入了aui-info信息条
                        </div>
                    </div>
                </div>
            </li>
        </div>
    </div>
    <a id="active" href="###">
        <img src="images/active.png" alt="">
    </a>
    <footer class="aui-bar aui-bar-tab aui-border-t" id="footer">
        <a href="/" class="aui-bar-tab-item aui-active">
            <i class="iconfont icon-tubiaozhizuomoban-"></i>
            <div class="aui-bar-tab-label">练习</div>
        </a>
        <a href="###" class="aui-bar-tab-item">
            <i class="iconfont icon-kechengbiao"></i>
            <div class="aui-bar-tab-label">课程</div>
        </a>
        <a href="###" class="aui-bar-tab-item">
            <div class="aui-badge">99</div>
            <i class="iconfont icon-tiku"></i>
            <div class="aui-bar-tab-label">题库</div>
        </a>
        <a href="/my" class="aui-bar-tab-item">
            <div class="aui-dot"></div>
            <i class="iconfont icon-wode"></i>
            <div class="aui-bar-tab-label">我的</div>
        </a>
    </footer>
</div>
<% include footer.ejs %>
<script src="javascripts/layer/layer.js"></script>
<script src="javascripts/swiper.min.js"></script>
</body>
<script>
    const app = new Vue({
        el: '#app',
        data: {
            practicemenus1: [],
            practicemenus2: [],
            practicemenus3: [],
            practicemenus4: [],
            practicemenus5: []
        },
        created: function () {
            const self = this;
            $.ajax({
                url: "/getpracticemenu",
                type: 'POST',
                dataType: 'json',
                data: {'bigid': 1},
                success: function (data) {
                    self.practicemenus1 = data.data
                    console.log(data)
                },
                error: function (e) {
                    console.log(e)
                }
            });
        },
        methods: {
            getpracticemenu: function (bigid) {
                const self = this;
                $.ajax({
                    url: "/getpracticemenu",
                    type: 'POST',
                    dataType: 'json',
                    data: {'bigid': bigid},
                    success: function (data) {
                        switch (bigid) {
                            case 1:
                                self.practicemenus1 = data.data;
                                break
                            case 2:
                                self.practicemenus2 = data.data;
                                break
                            case 3:
                                self.practicemenus3 = data.data;
                                break
                            case 4:
                                self.practicemenus4 = data.data;
                                break
                            case 5:
                                self.practicemenus5 = data.data;
                                break
                        }
                        console.log(data)
                    },
                    error: function (e) {
                        console.log(e)
                    }
                });
            }
        }
    })

    $(function () {
        //暂时设计每个slide大小需要一致
        barwidth = 36 //导航粉色条的长度px
        tSpeed = 300 //切换速度300ms
        const navSwiper = new Swiper('#nav', {
            slidesPerView: 5,
            freeMode: true,
            on: {
                init: function () {
                    navSlideWidth = this.slides.eq(0).css('width'); //导航字数需要统一,每个导航宽度一致
                    bar = this.$el.find('.bar')
                    bar.css('width', navSlideWidth)
                    bar.transition(tSpeed)
                    navSum = this.slides[this.slides.length - 1].offsetLeft //最后一个slide的位置
                    clientWidth = parseInt(this.$wrapperEl.css('width')) //Nav的可视宽度
                    navWidth = 0
                    for (i = 0; i < this.slides.length; i++) {
                        navWidth += parseInt(this.slides.eq(i).css('width'))
                    }
                    topBar = this.$el.parents('body').find('#top') //页头
                }
            }
        });
        const pageSwiper = new Swiper('#page', {
            watchSlidesProgress: true,
            resistanceRatio: 0,
            autoHeight: true,
            observer:true,
            on: {
                touchMove: function () {
                    progress = this.progress
                    bar.transition(0)
                    bar.transform('translateX(' + navSum * progress + 'px)')
                    //粉色66,129,239灰色51,51,51
                    for (i = 0; i < this.slides.length; i++) {
                        slideProgress = this.slides[i].progress
                        if (Math.abs(slideProgress) < 1) {
                            r = Math.floor((66 - 51) * (1 - Math.pow(Math.abs(slideProgress), 2)) + 51)
                            g = Math.floor((129 - 51) * (1 - Math.pow(Math.abs(slideProgress), 2)) + 51)
                            b = Math.floor((239 - 51) * (1 - Math.pow(Math.abs(slideProgress), 2)) + 51)
                            navSwiper.slides.eq(i).find('span').css('color', 'rgba(' + r + ',' + g + ',' + b + ',1)')
                        }
                    }
                },
                slideNextTransitionEnd: function(swiper){
                    pageSwiper.update();
                },
                transitionStart: function () {
                    $.ajax({
                        url: "/getpracticemenu",
                        type: 'POST',
                        dataType: 'json',
                        data: {'bigid': pageSwiper.activeIndex+1},
                        success: function (data) {
                            switch (pageSwiper.activeIndex+1) {
                                case 1:
                                    app.$data.practicemenus1 = data.data;
                                    break
                                case 2:
                                    app.$data.practicemenus2 = data.data;
                                    break
                                case 3:
                                    app.$data.practicemenus3 = data.data;
                                    break
                                case 4:
                                    app.$data.practicemenus4 = data.data;
                                    break
                                case 5:
                                    app.$data.practicemenus5 = data.data;
                                    break
                            }

                        },
                        error: function (e) {
                            console.log(e)
                        }
                    });
                    activeIndex = this.activeIndex
                    activeSlidePosition = navSwiper.slides[activeIndex].offsetLeft
                    //释放时导航粉色条移动过渡
                    bar.transition(tSpeed)
                    bar.transform('translateX(' + activeSlidePosition + 'px)')
                    //释放时文字变色过渡
                    navSwiper.slides.eq(activeIndex).find('span').transition(tSpeed)
                    navSwiper.slides.eq(activeIndex).find('span').css('color', 'rgba(66,129,239,1)')
                    if (activeIndex > 0) {
                        navSwiper.slides.eq(activeIndex - 1).find('span').transition(tSpeed)
                        navSwiper.slides.eq(activeIndex - 1).find('span').css('color', 'rgba(51,51,51,1)')
                    }
                    if (activeIndex < this.slides.length) {
                        navSwiper.slides.eq(activeIndex + 1).find('span').transition(tSpeed)
                        navSwiper.slides.eq(activeIndex + 1).find('span').css('color', 'rgba(51,51,51,1)')
                    }
                    //导航居中
                    navActiveSlideLeft = navSwiper.slides[activeIndex].offsetLeft //activeSlide距左边的距离

                    navSwiper.setTransition(tSpeed)
                    if (navActiveSlideLeft < (clientWidth - parseInt(navSlideWidth)) / 2) {
                        navSwiper.setTranslate(0)
                    } else if (navActiveSlideLeft > navWidth - (parseInt(navSlideWidth) + clientWidth) / 2) {
                        navSwiper.setTranslate(clientWidth - navWidth)
                    } else {
                        navSwiper.setTranslate((clientWidth - parseInt(navSlideWidth)) / 2 - navActiveSlideLeft)
                    }

                },
            }
        });

        navSwiper.$el.on('touchstart', function (e) {
            e.preventDefault() //去掉按压阴影
        })
        navSwiper.on('tap', function (e) {
            clickIndex = this.clickedIndex
            clickSlide = this.slides.eq(clickIndex)
            pageSwiper.slideTo(clickIndex, 0);
            this.slides.find('span').css('color', 'rgba(51,51,51,1)');
            clickSlide.find('span').css('color', 'rgba(66,129,239,1)');
        })
        //内容滚动
        var scrollSwiper = new Swiper('.scroll', {
            //65是头部的高
            //36是top地址和搜索的高
            slidesOffsetBefore: 72,
            direction: 'vertical',
            freeMode: true,
            slidesPerView: 'auto',
            mousewheel: {
                releaseOnEdges: true
            },
            on: {
                touchMove: function () {
                    if (this.translate > 72 - 36 && this.translate < 72) {
                        topBar.transform('translateY(' + (this.translate - 72) + 'px)');
                    }
                },
                touchStart: function () {
                    startPosition = this.translate
                },
                touchEnd: function () {
                    topBar.transition(tSpeed)
                    if (this.translate > 36 && this.translate < 72 && this.translate < startPosition) {
                        topBar.transform('translateY(-36px)');
                        for (sc = 0; sc < scrollSwiper.length; sc++) {
                            if (scrollSwiper[sc].translate > 36) {
                                scrollSwiper[sc].setTransition(tSpeed);
                                scrollSwiper[sc].setTranslate(36)
                            }
                        }
                    }
                    if (this.translate > 36 && this.translate < 72 && this.translate > startPosition) {
                        topBar.transform('translateY(0px)');
                        for (sc = 0; sc < scrollSwiper.length; sc++) {
                            if (scrollSwiper[sc].translate < 72 && scrollSwiper[sc].translate > 0) {
                                scrollSwiper[sc].setTransition(tSpeed);
                                scrollSwiper[sc].setTranslate(72)
                            }
                        }
                    }
                },
                transitionStart: function () {
                    topBar.transition(tSpeed)
                    if (this.translate < 72 - 36) {
                        topBar.transform('translateY(-36px)');
                        if (scrollSwiper) {
                            for (sc = 0; sc < scrollSwiper.length; sc++) {
                                if (scrollSwiper[sc].translate > 36) {
                                    scrollSwiper[sc].setTransition(tSpeed);
                                    scrollSwiper[sc].setTranslate(36)
                                }
                            }
                        }
                    } else {
                        topBar.transform('translateY(0px)');
                        if (scrollSwiper) {
                            for (sc = 0; sc < scrollSwiper.length; sc++) {
                                if (scrollSwiper[sc].translate < 72 && scrollSwiper[sc].translate > 0) {
                                    scrollSwiper[sc].setTransition(tSpeed);
                                    scrollSwiper[sc].setTranslate(72)
                                }
                            }
                        }
                    }
                }
            }
        })
        /*layer.ready(function () {
            layer.open({
                type: 1,
                title: false,
                closeBtn:2,
                area: '85%',
                content: $('#active')
            });
        });*/
    })
</script>
</html>